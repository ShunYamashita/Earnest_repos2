//--------------------------------------------------------------------------------------
//  キャラクターAIクラス   ( characterAI.cpp )
//
//  Author : SHUN YAMASHITA
//--------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------
//  ヘッダーファイル
//--------------------------------------------------------------------------------------
#include "characterAI.h"
#include "scene.h"
#include "rootNodeAI.h"
#include "imgui_impl_dx9.h"

//--------------------------------------------------------------------------------------
//  マクロ定義
//--------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------
//  コンストラクタ
//--------------------------------------------------------------------------------------
CharacterAI::CharacterAI( )
{

}

//--------------------------------------------------------------------------------------
//  初期化処理
//--------------------------------------------------------------------------------------
void CharacterAI::Init( void )
{
	m_active = true;

	//  ルートノードの作成
	m_rootNodeAI = new RootNodeAI( this );
}

//--------------------------------------------------------------------------------------
//  終了処理
//--------------------------------------------------------------------------------------
void CharacterAI::Uninit( void )
{

}

//--------------------------------------------------------------------------------------
//  更新処理
//--------------------------------------------------------------------------------------
void CharacterAI::Update( void )
{
	//  存在していて実行状態の場合
	if( m_rootNodeAI != nullptr )
	{
		if( m_active )
		{
			m_rootNodeAI->JudgeActive( );

			m_rootNodeAI->Run( );
		}
	}
}

//--------------------------------------------------------------------------------------
//  デバッグ描画
//--------------------------------------------------------------------------------------
void CharacterAI::DrawDebug( void )
{
	std::string work = m_name + "AI";

	if( ImGui::TreeNode( work.c_str( ) ) ) 
	{
		if( m_rootNodeAI != nullptr )
		{
			m_rootNodeAI->DrawDebug( );
		}	

		ImGui::TreePop( );
	}
}

//--------------------------------------------------------------------------------------
//  対象オブジェクトの取得
//--------------------------------------------------------------------------------------
Scene* CharacterAI::GetScene( void )
{
	return m_scene;
}

//--------------------------------------------------------------------------------------
//  アクティブ状態かのフラグ取得
//--------------------------------------------------------------------------------------
bool CharacterAI::GetActive( void )
{
	return m_active;
}

//--------------------------------------------------------------------------------------
//  更新処理
//--------------------------------------------------------------------------------------
CharacterAI* CharacterAI::Create( std::string name , Scene* scene )
{
	CharacterAI* characterAI = new CharacterAI;

	//  名前の代入
	characterAI->m_name = name;

	//  対象オブジェクトの代入
	characterAI->m_scene = scene;

	//  初期化
	characterAI->Init( );

	return characterAI;
}